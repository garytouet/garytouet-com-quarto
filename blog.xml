<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Gary Touet</title>
<link>https://garytouet.com/blog.html</link>
<atom:link href="https://garytouet.com/blog.xml" rel="self" type="application/rss+xml"/>
<description>A mix of my own writing and links to what I find interesting.</description>
<language>en</language>
<generator>quarto-1.8.26</generator>
<lastBuildDate>Fri, 14 Nov 2025 00:00:00 GMT</lastBuildDate>
<item>
  <title>Analysing the sound of my fridge</title>
  <link>https://garytouet.com/post/2025/fridge-sound-analysis/</link>
  <description><![CDATA[ 




<section id="backstory" class="level2">
<h2 class="anchored" data-anchor-id="backstory">Backstory</h2>
<p>This is a fun little project that I wanted to try for a bit now. You see, my fridge at home is very old. It has always been noisy, but I‚Äôve been able to ignore it for many years.</p>
<p>However, lately, something changed. It feels like the compressor runs louder and more frequently than before (too high of a frequency according to my nerves).</p>
<p>I wanted to quantify two things:</p>
<ol type="1">
<li>How long the compressor runs for each time,</li>
<li>How long between each compressor run.</li>
</ol>
<p>I tried timing it manually, but I ran into issues and I didn‚Äôt trust my measurements to be accurate. It‚Äôs tedious to stay alert to a fridge‚Äôs background hum while at home. üòÉ</p>
<p>I wanted something more scientific and decided to use my iPad and the <em>Voice Memos</em> app to record the sound. I had the vague idea that with the sound waves and timestamps I could reach my goals.</p>
<p>To make this easy, I wanted to record for rather long periods of time and to have clean recordings. So I left the iPad record while I was away for most of the day.</p>
<p>My first idea was to do my analysis with the <em>naked</em> eye, but later I decided that it would be more fun to find a programmatic way to do it. I wanted to put my recently-acquired Mistral AI subscription to the test.</p>
</section>
<section id="mistral-ai" class="level2">
<h2 class="anchored" data-anchor-id="mistral-ai">Mistral AI</h2>
<p>The company and its models are often mentioned as <a href="https://madebuy.eu/european/ai-chatbots/">European alternatives to US firms and their models</a>. I wanted to give it a go and get familiar with it. In addition, Mistral and I are both born in France. These were enough reasons for me to sign up to the <em>Pro</em> tier and to start experimenting.</p>
<p>My setup was:</p>
<ul>
<li>Local machine (Macbook Air M3)</li>
<li>Working in Python inside Visual Studio Code</li>
<li>Using <em>Codestral</em> within VS Code itself <sup>1</sup></li>
</ul>
<p><em>Codestral</em> is Mistral AI‚Äôs <code>generative AI model explicitly designed for code generation tasks</code>.</p>
<p>I went into this with prior Python coding knowledge, but I had never done any audio processing with it. So I gave the LLM a broad description of what I wanted to achieve. I didn‚Äôt recommend packages, or specific methods. I only described what I had and what I wanted to achieve very broadly.</p>
<p>Initial prompt:</p>
<blockquote class="blockquote">
<p>I have a file ‚Äú.m4a‚Äù which is a recording of my fridge at home. I want to analyse the sound inside of this file to identify each time the fridge‚Äôs compressor runs. The sound is very distinctive and I know that in this file there are two compressor runs which lasts very long times. What should I do in Python?</p>
</blockquote>
<p>I‚Äôll cut the story short, it disappointed me for the task at hand:</p>
<ol type="1">
<li>I spent a few hours re-prompting, giving more precise instructions, explicitly asking for things and I never managed to get to something useful. The script was producing code that worked. All the packages used were safe and well-known. It was ‚Äúanalysing‚Äù my audio file and producing good data visualisations, but it couldn‚Äôt identify the compressor runs properly.</li>
<li>The code produced was very slow to run. It took between 5 and 10 mins each time. This made debugging and iterating very slow.</li>
<li>Finally, in a different session, I tried prompting Mistral on the web. I supposed that my configuration in VS Code might be faulty. At first, it gave me interesting results, but I still stumbled in the last mile and couldn‚Äôt get to something useful.</li>
</ol>
<blockquote class="blockquote">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://garytouet.com/post/2025/fridge-sound-analysis/output-codestral.png" class="img-fluid figure-img"></p>
<figcaption>Last analysis generated before I gave up. The dashed red line is supposed to be a threshold used for detection. However, it does not seem to matter since data below the threshold is highlighted as <em>compressor run</em>‚Ä¶</figcaption>
</figure>
</div>
</blockquote>
</section>
<section id="claude-to-the-rescue" class="level2">
<h2 class="anchored" data-anchor-id="claude-to-the-rescue">Claude to the rescue!</h2>
<p>Frustrated, I decided to copy and paste my initial prompt in Claude‚Äôs web UI. I am not a paying subscriber so I am using <code>Claude Sonnet 4.5</code> on the free tier.</p>
<p>And‚Ä¶ To my surprise, it worked in 7 iterations. ü•≤</p>
<ol type="1">
<li><p>The very first script that it generated was much faster than the one from Codestral: less than ten seconds vs.&nbsp;several minutes before.</p></li>
<li><p>Its first attempt produced a graph that didn‚Äôt show which sections of the audio were identified as compressor runs. After I asked for it, it produced code that generated this graph. It was very easy to go from there to a finished analysis.</p>
<blockquote class="blockquote">
<p><img src="https://garytouet.com/post/2025/fridge-sound-analysis/output-claude-first-attempt.png" class="img-fluid"></p>
</blockquote></li>
<li><p>It produced parameters that I could manually tune. It explained to me what these parameters were doing with example values to illustrate. For example:</p>
<blockquote class="blockquote">
<p>Lower (e.g., 60): More sensitive, catches quieter compressor runs but may have false positives</p>
<p>Higher (e.g., 80-90): Only catches louder/clearer runs, fewer false positives</p>
</blockquote></li>
<li><p>After my 7th iteration, I had this output (pretty clean!):</p>
<blockquote class="blockquote">
<p><img src="https://garytouet.com/post/2025/fridge-sound-analysis/output-claude-end.png" class="img-fluid"></p>
<p>Total segments above threshold: 11</p>
<p>Segments after filtering (‚â•900s): 2</p>
<p>Detected 2 compressor run(s):</p>
<ul>
<li>Run 1: 18.07min - 49.33min (duration: 31.27min)</li>
<li>Run 2: 132.93min - 164.40min (duration: 31.47min)</li>
</ul>
Time between runs:
<ul>
<li>Between Run 1 and Run 2: 83.60min</li>
</ul>
</blockquote></li>
</ol>
<p>The code generated by Claude was better because:</p>
<ol type="1">
<li>The detection method worked much better from the get-go. And the code generated ran fast from the start too.</li>
<li>It used parameters whose values were based on my audio file. For example, the detection threshold was the nth percentile of a metric computed on the audio data itself. Manually tuning this percentile threshold was intuitive too.</li>
<li>It even proactively handled an edge case: what if the recording stops before the end of a compressor run.</li>
<li>I have the feeling that Claude was more responsive to my input and request for change too. Maybe this has to do with a difference in the length of the context windows (6 times longer for Claude Sonnet 4.5 vs.&nbsp;Codestral in my use case)<sup>2</sup>.</li>
</ol>
<p>In any case, this provided me with good findings and lessons learned for future projects, especially if I want to persevere with Mistral.</p>
</section>
<section id="back-to-the-analysis" class="level2">
<h2 class="anchored" data-anchor-id="back-to-the-analysis">Back to the analysis</h2>
<p>I pointed the final script (code generated by Claude with my manual parameter-tuning) to a recording that lasts eight hours and thirty minutes:</p>
<div id="f19f1f71" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> librosa</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Load the audio file</span></span>
<span id="cb1-6">audio, sr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> librosa.load(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"audio/fridge-1-clean.m4a"</span>, sr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Calculate RMS energy over time windows</span></span>
<span id="cb1-9">frame_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjust this</span></span>
<span id="cb1-10">hop_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjust this</span></span>
<span id="cb1-11">rms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> librosa.feature.rms(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>audio, frame_length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>frame_length, hop_length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>hop_length)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Detect high-energy periods (compressor running)</span></span>
<span id="cb1-14">threshold <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.percentile(rms, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjust this</span></span>
<span id="cb1-15">is_running <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> threshold</span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Get time values</span></span>
<span id="cb1-18">times <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> librosa.frames_to_time(np.arange(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(rms)), sr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sr, hop_length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>hop_length)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5. Extract running segments</span></span>
<span id="cb1-21">running_segments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb1-22">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb1-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, running <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(is_running):</span>
<span id="cb1-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> running <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> start <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-25">        start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i</span>
<span id="cb1-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> running <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> start <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-27">        running_segments.append((times[start], times[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span>
<span id="cb1-28">        start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb1-29"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> start <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle case where recording ends while running</span></span>
<span id="cb1-30">    running_segments.append((times[start], times[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 6. FILTER BY MINIMUM DURATION</span></span>
<span id="cb1-33">min_duration <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">900</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># seconds - adjust this based on your compressor</span></span>
<span id="cb1-34">running_segments_filtered <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb1-35">    (start, end) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> start, end <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> running_segments <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> min_duration</span>
<span id="cb1-36">]</span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 7. Create mask for filtered segments only</span></span>
<span id="cb1-39">is_running_filtered <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(is_running, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>)</span>
<span id="cb1-40"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> start_time, end_time <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> running_segments_filtered:</span>
<span id="cb1-41">    mask <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (times <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> start_time) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> (times <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> end_time)</span>
<span id="cb1-42">    is_running_filtered <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|=</span> mask</span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 8. Visualize with highlighted compressor runs</span></span>
<span id="cb1-45">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb1-46"></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the RMS energy in minutes</span></span>
<span id="cb1-48">times_minutes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> times <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span></span>
<span id="cb1-49">plt.plot(times_minutes, rms, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RMS Energy"</span>)</span>
<span id="cb1-50"></span>
<span id="cb1-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Highlight filtered compressor running periods</span></span>
<span id="cb1-52">plt.fill_between(</span>
<span id="cb1-53">    times_minutes,</span>
<span id="cb1-54">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb1-55">    rms,</span>
<span id="cb1-56">    where<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>is_running_filtered,</span>
<span id="cb1-57">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb1-58">    alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb1-59">    label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Compressor Running"</span>,</span>
<span id="cb1-60">)</span>
<span id="cb1-61"></span>
<span id="cb1-62">plt.axhline(threshold, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Threshold"</span>)</span>
<span id="cb1-63">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time (minutes)"</span>)</span>
<span id="cb1-64">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RMS Energy"</span>)</span>
<span id="cb1-65">plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Fridge Compressor Activity Detection (min duration: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>min_duration<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">s)"</span>)</span>
<span id="cb1-66">plt.legend()</span>
<span id="cb1-67">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span>
<span id="cb1-68">plt.tight_layout()</span>
<span id="cb1-69">plt.show()</span>
<span id="cb1-70"></span>
<span id="cb1-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 9. Print detection summary</span></span>
<span id="cb1-72"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Total segments above threshold: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(running_segments)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-73"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Segments after filtering (‚â•</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>min_duration<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">s): </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(running_segments_filtered)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-74"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Detected </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(running_segments_filtered)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> compressor run(s):"</span>)</span>
<span id="cb1-75"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, (start_time, end_time) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(running_segments_filtered, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb1-76">    duration_minutes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (end_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start_time) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span></span>
<span id="cb1-77">    start_minutes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> start_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span></span>
<span id="cb1-78">    end_minutes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> end_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span></span>
<span id="cb1-79">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(</span>
<span id="cb1-80">        <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"  Run </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>start_minutes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">min - </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>end_minutes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">min (duration: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>duration_minutes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">min)"</span></span>
<span id="cb1-81">    )</span>
<span id="cb1-82"></span>
<span id="cb1-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 10. Calculate and print time between runs</span></span>
<span id="cb1-84"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(running_segments_filtered) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb1-85">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Time between runs:"</span>)</span>
<span id="cb1-86">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(running_segments_filtered) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb1-87">        end_of_current <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> running_segments_filtered[i][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-88">        start_of_next <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> running_segments_filtered[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-89">        gap_minutes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (start_of_next <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> end_of_current) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span></span>
<span id="cb1-90">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"  Between Run </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> and Run </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>gap_minutes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">min"</span>)</span></code></pre></div></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://garytouet.com/post/2025/fridge-sound-analysis/index_files/figure-html/cell-2-output-1.png" width="854" height="278" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Total segments above threshold: 267
Segments after filtering (‚â•900s): 4

Detected 4 compressor run(s):
  Run 1: 67.60min - 103.00min (duration: 35.40min)
  Run 2: 186.40min - 222.13min (duration: 35.73min)
  Run 3: 307.53min - 341.60min (duration: 34.07min)
  Run 4: 427.20min - 460.67min (duration: 33.47min)

Time between runs:
  Between Run 1 and Run 2: 83.40min
  Between Run 2 and Run 3: 85.40min
  Between Run 3 and Run 4: 85.60min</code></pre>
</div>
</div>
<p>The compressor runs are easily identifiable in the plot and, as the red zones show, the detection mechanism works very well at identifying them.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>What we were all dying to know is now revealed to us. The compressor in my fridge runs for roughly 33-35 minutes each time and it runs every 83-85 minutes.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>This is not natively supported and needs to be configured via Continue.dev‚Äôs extension (<a href="https://docs.mistral.ai/capabilities/code_generation?tab=codestral-integrations#explorer-tabs-integrations">documentation</a>).‚Ü©Ô∏é</p></li>
<li id="fn2"><p>Mistral‚Äôs documentation mentions <a href="https://mistral.ai/fr/news/codestral">32k for Codestral</a>. And Anthropic gives an example where <a href="https://docs.claude.com/en/docs/build-with-claude/context-windows#context-awareness-in-claude-sonnet-4-5-and-haiku-4-5">200k tokens are the size of the <em>standard</em> window</a>, which would correspond to my free tier.‚Ü©Ô∏é</p></li>
</ol>
</section></div> ]]></description>
  <category>python</category>
  <category>ai assisted coding</category>
  <category>fun project</category>
  <guid>https://garytouet.com/post/2025/fridge-sound-analysis/</guid>
  <pubDate>Fri, 14 Nov 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Anil Dash on today‚Äôs discourse regarding AI</title>
  <link>https://garytouet.com/link/2025/11/04/anil-dash-ai-majority-view/</link>
  <description><![CDATA[ 




<p>Anil Dash (emphasis is his):</p>
<blockquote class="blockquote">
<p>Most people who actually have technical roles within the tech industry, like engineers, product managers, and others who actually make the technologies we all use, are fluent in the latest technologies like LLMs. They aren‚Äôt the big, loud billionaires that usually get treated as the spokespeople for all of tech.</p>
<p>And what they all share is an extraordinary degree of consistency in their feelings about AI, which can be pretty succinctly summed up:</p>
<p><strong>Technologies like LLMs have utility, but the absurd way they‚Äôve been over-hyped, the fact they‚Äôre being forced on everyone, and the insistence on ignoring the many valid critiques about them make it very difficult to focus on legitimate uses where they might add value.</strong></p>
</blockquote>
<p>Definitely agree with him. It was refreshing to read.</p>
<p>These days, I spend more time than usual on LinkedIn and I follow the Tech news more consistently. I often question my own judgment and my own sanity while reading.</p>
<p>The amount of blind embrace for this technology in the mainstream‚Äôs discourse is astounding in my opinion. I‚Äôm looking forward to the next stage of the <a href="https://en.wikipedia.org/wiki/Gartner_hype_cycle">hype cycle</a>, when reality sets in and expectations lower, to have more interesting discussions.</p>



 ]]></description>
  <category>link</category>
  <category>ai</category>
  <guid>https://garytouet.com/link/2025/11/04/anil-dash-ai-majority-view/</guid>
  <pubDate>Tue, 04 Nov 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Creating the favicon for this website with ggplot2</title>
  <link>https://garytouet.com/post/2025/create-favicon-with-ggplot2/</link>
  <description><![CDATA[ 




<section id="favicon-what-is-it" class="level2">
<h2 class="anchored" data-anchor-id="favicon-what-is-it">Favicon ‚Äì what is it?</h2>
<p>Quoting from <a href="https://developer.mozilla.org/en-US/docs/Glossary/Favicon">Mozilla‚Äôs documentation</a>:</p>
<blockquote class="blockquote">
<p>A favicon (favorite icon) is a tiny icon included along with a website, which is displayed in places like the browser‚Äôs address bar, page tabs and bookmarks menu.</p>
<p>[‚Ä¶]</p>
<p>They are used to improve user experience and enforce brand consistency. When a familiar icon is seen in the browser‚Äôs address bar, for example, it helps users know they are in the right place.</p>
</blockquote>
</section>
<section id="what-kind-of-graphic-am-i-trying-to-create" class="level2">
<h2 class="anchored" data-anchor-id="what-kind-of-graphic-am-i-trying-to-create">What kind of graphic am I trying to create?</h2>
<p>I‚Äôm trying to re-create the favicon used for a previous iteration of my personal website:</p>
<ul>
<li>Square shape</li>
<li>Solid blue background color</li>
<li>My initials ‚ÄúGT‚Äù positioned on top, towards the bottom of the square.</li>
</ul>
<p>I‚Äôm starting simple. Should be doable, right?</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>Installing and loading <code>ggplot2</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggplot2'</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>)</span></code></pre></div></div>
</div>
<p>Here, I set the default size of my plots for the rest of the document. It is an important setting since I will generate a square icon and, <a href="https://quarto.org/docs/computations/execution-options.html#figure-options">by default, dimensions are 7 x 5 inches</a>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb2-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb2-4">)</span></code></pre></div></div>
</div>
</section>
<section id="creating-the-graphic" class="level2">
<h2 class="anchored" data-anchor-id="creating-the-graphic">Creating the graphic</h2>
<p>I decided to tackle the blue background first. I remembered that ggplot has different <a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geoms</a> to create a square. I looked up the documentation and started coding.</p>
<p>I iterated through <code>geom_raster()</code>, <code>geom_rect()</code> and landed on <code>geom_tile()</code>. It is best suited for my use case. I just need to define the size of the square and use the origin (0,0) as the center of the square.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">square_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb3-2">my_blue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0063dc"</span></span>
<span id="cb3-3"></span>
<span id="cb3-4">(p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(</span>
<span id="cb3-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> square_size, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> square_size),</span>
<span id="cb3-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_blue</span>
<span id="cb3-8">  ))</span></code></pre></div></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://garytouet.com/post/2025/create-favicon-with-ggplot2/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Now, I will 1) add the text, position it, and then 2) remove all plot elements like grid lines, axes, etc.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">(p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>square_size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GT"</span>,</span>
<span id="cb4-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Inter"</span>,</span>
<span id="cb4-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-9">    ),</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> square_size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size.unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'in'</span></span>
<span id="cb4-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span>
<span id="cb4-15">)</span></code></pre></div></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://garytouet.com/post/2025/create-favicon-with-ggplot2/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>Voil√†!</p>
<p>On purpose, I defined the position of the text and its size as a factor of the variable <code>square_size</code>. I hope that it will make it easier to export this graphic in different sizes after.</p>
<p>Regarding the font, I‚Äôm using <a href="https://rsms.me/inter/">Inter</a>. I had to download and install it on Mac OS for it to become available in the plot.</p>
</section>
<section id="saving-in-various-sizes-and-formats" class="level2">
<h2 class="anchored" data-anchor-id="saving-in-various-sizes-and-formats">Saving in various sizes and formats</h2>
<p>This is when things get more complicated for two reasons:</p>
<ol type="1">
<li>No clear spec for favicons exists. It depends on browsers, mobile OSes. Different formats, different sizes.</li>
<li>Resizing a plot is not as straightforward as I thought</li>
</ol>
<section id="favicon-specs" class="level3">
<h3 class="anchored" data-anchor-id="favicon-specs">Favicon specs</h3>
<p>While browsing, I found various specs<sup>1</sup> for this favicon. I will spare you the details. In the end, I landed on the following:</p>
<ol type="1">
<li><code>favicon.ico</code> 32x32 (px)</li>
<li><code>favicon.png</code> 96x96 (px)</li>
<li><code>apple-touch-icon.png</code> 180x180 (px)</li>
<li><code>favicon.svg</code></li>
</ol>
</section>
<section id="scaling-issues" class="level3">
<h3 class="anchored" data-anchor-id="scaling-issues">Scaling issues</h3>
<p>So far, I‚Äôve set all my measurements in inches (figure size, font size). Now, my goal is to provide a size in pixels and to automatically resize and scale the icon accordingly.</p>
<p>The problem is‚Ä¶</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb5-2">  p,</span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"icons/favicon_problem.png"</span>,</span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'retina'</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#retina = 320, according to documentation</span></span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>,</span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>,</span>
<span id="cb5-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'px'</span></span>
<span id="cb5-8">)</span></code></pre></div></div>
</div>
<p><img src="https://garytouet.com/post/2025/create-favicon-with-ggplot2/icons/favicon_problem.png" class="img-fluid"></p>
<p>‚Ä¶ that the dimensions are good, but the proportions are not. With <code>ggsave</code> I can easily define the size in pixels, but this doesn‚Äôt change the font size in the plot.</p>
<p>Christophe Nicault‚Äôs article <a href="https://www.christophenicault.com/post/understand_size_dimension_ggplot2/">Understanding text size and resolution in ggplot2</a> explains very well what happens. They recommend to use a package called <code>ragg</code> and the <code>scaling</code> option.</p>
<p>I tried, but simply installing <code>ragg</code> created a big error<sup>2</sup> in Quarto and completely destroyed my ability to preview my post. I also played around with the <code>scale</code> option in <code>ggsave()</code>, to no avail.</p>
<p>As a result, I decided to handle the scaling myself.</p>
</section>
<section id="diy-scaling" class="level3">
<h3 class="anchored" data-anchor-id="diy-scaling">DIY scaling</h3>
<p>Since I‚Äôve defined sizes in inches when creating the graphic and since I want to express icon dimensions in pixels, I need to understand the relationship between inches and pixels first.</p>
<p>From <a href="https://www.christophenicault.com/post/understand_size_dimension_ggplot2/">Understanding text size and resolution in ggplot2</a>:</p>
<blockquote class="blockquote">
<p>The relation is : (size in inches) = (screen size in pixel) / PPI or (screen size in pixel) = DPI * (size in inches)</p>
</blockquote>
<p>In other words, if I want an icon with size 32 x 32 pixels, the conversion in inches will be <code>32 / 320 = 0.1</code> (with a resolution of 320). I can create a function that takes these two parameters as arguments, converts that to a measurement in inches and then passes that to <code>ggplot2</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function that creates the icon with sizes in inches</span></span>
<span id="cb6-2">create_icon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(square_size_inches) {</span>
<span id="cb6-3">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>(</span>
<span id="cb6-5">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb6-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> square_size_inches,</span>
<span id="cb6-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> square_size_inches</span>
<span id="cb6-10">      ),</span>
<span id="cb6-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> my_blue</span>
<span id="cb6-12">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb6-14">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb6-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>square_size_inches <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb6-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GT"</span>,</span>
<span id="cb6-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Inter"</span>,</span>
<span id="cb6-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb6-20">      ),</span>
<span id="cb6-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb6-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> square_size_inches <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb6-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size.unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'in'</span></span>
<span id="cb6-24">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span>
<span id="cb6-26"></span>
<span id="cb6-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(p)</span>
<span id="cb6-28">  }</span>
<span id="cb6-29"></span>
<span id="cb6-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function that uses a size in pixels and a dpi to convert it into inches, create the icon and save it to disk</span></span>
<span id="cb6-31">create_and_save_icon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(filename, size_pixels, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">320</span>) {</span>
<span id="cb6-32">  square_size_inches <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> size_pixels <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> dpi</span>
<span id="cb6-33">  icon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_icon</span>(square_size_inches)</span>
<span id="cb6-34"></span>
<span id="cb6-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb6-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> icon,</span>
<span id="cb6-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> filename,</span>
<span id="cb6-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> dpi,</span>
<span id="cb6-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> size_pixels,</span>
<span id="cb6-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> size_pixels,</span>
<span id="cb6-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'px'</span>,</span>
<span id="cb6-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> my_blue <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#otherwise white outline in png</span></span>
<span id="cb6-43">  )</span>
<span id="cb6-44">}</span></code></pre></div></div>
</div>
<p>Let‚Äôs try it out!</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_and_save_icon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'icons/favicon_32x32.png'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size_pixels =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">320</span>)</span></code></pre></div></div>
</div>
<p><img src="https://garytouet.com/post/2025/create-favicon-with-ggplot2/icons/favicon_32x32.png" class="img-fluid"></p>
<p>It works! I can now generate the different sizes that I need.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">sizes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (size <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sizes) {</span>
<span id="cb8-4">  filename <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'icons/favicon_'</span>, size, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>, size, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'.png'</span>)</span>
<span id="cb8-5"></span>
<span id="cb8-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_and_save_icon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> filename, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size_pixels =</span> size, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">320</span>)</span>
<span id="cb8-7">}</span></code></pre></div></div>
</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://garytouet.com/post/2025/create-favicon-with-ggplot2/icons/favicon_32x32.png" class="img-fluid figure-img"></p>
<figcaption>favicon_32x32.png</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://garytouet.com/post/2025/create-favicon-with-ggplot2/icons/favicon_96x96.png" class="img-fluid figure-img"></p>
<figcaption>favicon_96x96.png</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://garytouet.com/post/2025/create-favicon-with-ggplot2/icons/favicon_180x180.png" class="img-fluid figure-img"></p>
<figcaption>favicon_180x180.png</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>And for the last one, the <code>.svg</code> version. Here, we‚Äôll use the base R built-in SVG graphics device:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">icon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_icon</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">svg</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"icons/favicon.svg"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(icon)</span>
<span id="cb9-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">invisible</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dev.off</span>())</span></code></pre></div></div>
</div>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://garytouet.com/post/2025/create-favicon-with-ggplot2/icons/favicon.svg" class="img-fluid figure-img"></p>
<figcaption>favicon.svg</figcaption>
</figure>
</div>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Most complete article that I could find: RealFaviconGenerator‚Äôs <a href="https://realfavicongenerator.net/favicon-guides/understanding-favicon-elements">Understanding favicon elements</a>.‚Ü©Ô∏é</p></li>
<li id="fn2"><p><code>quarto preview</code> would throw a <code>segfault</code> error that I was not able to resolve.‚Ü©Ô∏é</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <category>website</category>
  <guid>https://garytouet.com/post/2025/create-favicon-with-ggplot2/</guid>
  <pubDate>Thu, 25 Sep 2025 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
